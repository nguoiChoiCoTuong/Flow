<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Flow</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="icon" href="images/sea-waves.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      height: 100vh;
      display: flex;
      flex-direction: column;
      background-color: skyblue;
    }

    /* Navbar */
    .navbar {
      background-color: #0077b6;
      color: white;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: bold;
    }

    .navbar button {
      background: white;
      border: none;
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    /* Layout */
    #content {
      flex: 1;
      display: flex;
    }

    #weather-info {
      width: 35%;
      padding: 20px;
      background: #f9f9f9;
      overflow-y: auto;
      background-color: skyblue;
    }

    #map {
      flex: 1;
    }

    .card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      padding: 15px;
      margin-bottom: 20px;
    }

    .forecast-day {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px solid #eee;
    }

    .forecast-day:last-child {
      border-bottom: none;
    }
  </style>
</head>

<body>
  <!-- Navbar -->
  <div class="navbar">
    üåä Flow
    <button onclick="toggleUnit()">Switch ¬∞C / ¬∞F</button>
  </div>

  <div id="content">
    <div id="weather-info">
      <div class="card">
        <h2 id="city-name">Ha Noi</h2>
        <p id="desc">---</p>
        <p><i class="fa-solid fa-temperature-high" style="color: gray"></i>
          <b>Temperature:</b> <span id="temp">-- ¬∞C</span>
        </p>
        <p><i class="fa-solid fa-water" style="color: blue"></i>
          <b>Humidity:</b> <span id="humidity">--%</span>
        </p>
        <p><i class="fa-solid fa-wind" style="color: green"></i>
          <b>Wind:</b> <span id="wind">-- km/h</span>
        </p>
        <p><i class="fa-solid fa-eye" style="color: purple"></i>
          <b>Visibility:</b> <span id="visibility">-- km</span>
        </p>
      </div>

      <div class="card">
        <h3>5-Day Forecast</h3>
        <div id="forecast-container"></div>
      </div>
      <div class="card">
        <h3>Advice</h3>
        <ul id="advice-list"></ul>
      </div>
    </div>

    <div id="map"></div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // T·∫°o map
    var map = L.map("map").setView([16, 107], 5);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "¬© OpenStreetMap"
    }).addTo(map);

    // D·ªØ li·ªáu tƒ©nh cho demo
    const weatherData = {
      "Hanoi": {
        current: { temp: "28", desc: "‚òÄÔ∏è Clear Sky", humidity: "70", wind: "8", visibility: "10" },
        forecast: [
          { day: "Today", icon: "‚òÄÔ∏è", min: 24, max: 30 },
          { day: "Tomorrow", icon: "‚õÖ", min: 23, max: 29 },
          { day: "Wednesday", icon: "üåßÔ∏è", min: 21, max: 27 },
          { day: "Thursday", icon: "‚òÄÔ∏è", min: 20, max: 26 },
          { day: "Friday", icon: "‚õÖ", min: 22, max: 28 }
        ]
      },
      "Ho Chi Minh": {
        current: { temp: "32", desc: "‚õÖ Partly Cloudy", humidity: "65", wind: "10", visibility: "12" },
        forecast: [
          { day: "Today", icon: "‚õÖ", min: 26, max: 34 },
          { day: "Tomorrow", icon: "‚òÄÔ∏è", min: 25, max: 33 },
          { day: "Wednesday", icon: "üåßÔ∏è", min: 24, max: 32 },
          { day: "Thursday", icon: "üå©Ô∏è", min: 25, max: 34 },
          { day: "Friday", icon: "‚òÄÔ∏è", min: 26, max: 35 }
        ]
      }
    };

    let currentUnit = "C"; // Default Celsius

    // H√†m update UI
    function updateWeather(city) {
      const data = weatherData[city];

      document.getElementById("city-name").innerText = city;
      document.getElementById("temp").innerText = data.current.temp + " ¬∞" + currentUnit;
      document.getElementById("desc").innerText = data.current.desc;
      document.getElementById("humidity").innerText = data.current.humidity + "%";
      document.getElementById("wind").innerText = data.current.wind + " km/h";
      document.getElementById("visibility").innerText = data.current.visibility + " km";

      // Advice
      const adviceListElem = document.getElementById("advice-list");
      adviceListElem.innerHTML = "";
      const tempValue = parseInt(data.current.temp);
      const advices = generateAdvice(
        tempValue,
        data.current.desc,
        data.current.humidity,
        data.current.wind
      );
      advices.forEach(a => {
        const li = document.createElement("li");
        li.textContent = a;
        adviceListElem.appendChild(li);
      });

      // Forecast
      const forecastContainer = document.getElementById("forecast-container");
      forecastContainer.innerHTML = "";
      data.forecast.forEach(f => {
        const min = formatTemp(f.min);
        const max = formatTemp(f.max);
        const div = document.createElement("div");
        div.className = "forecast-day";
        div.innerHTML = `<span>${f.icon} ${f.day}</span><span>${min} - ${max}</span>`;
        forecastContainer.appendChild(div);
      });
    }

    // H√†m ƒë·ªïi ƒë∆°n v·ªã
    function toggleUnit() {
      currentUnit = currentUnit === "C" ? "F" : "C";
      updateWeather(document.getElementById("city-name").innerText);
    }

    function formatTemp(value) {
      if (currentUnit === "C") {
        return value + "¬∞C";
      } else {
        return Math.round((value * 9 / 5) + 32) + "¬∞F";
      }
    }

    //H√†m t·∫°o l·ªùi khuy√™n
    function generateAdvice(temp, desc, humidity, wind) {
      const adviceList = [];
      if (temp < 0) adviceList.push("ü•∂ It's freezing! Wear warm coat, hat, and gloves.");
      else if (temp < 10) adviceList.push("üß• It's cold. A jacket is recommended.");
      else if (temp > 30) adviceList.push("üî• It's very hot. Wear light clothing and sunscreen.");
      else if (temp > 25) adviceList.push("üòé Nice weather! Light clothing is fine.");

      if (desc.includes("Rain") || desc.includes("üåßÔ∏è")) adviceList.push("‚òî Don't forget your umbrella.");
      if (desc.includes("Snow") || desc.includes("‚ùÑÔ∏è")) adviceList.push("‚ö†Ô∏è Roads may be slippery.");
      if (desc.includes("Clear") || desc.includes("‚òÄÔ∏è")) adviceList.push("üï∂Ô∏è Sunglasses recommended.");

      const windValue = parseInt(wind);
      if (windValue > 25) adviceList.push("üí® Strong winds today, be careful.");
      else if (windValue > 15) adviceList.push("üçÉ Moderate winds. A jacket may help.");

      const humValue = parseInt(humidity);
      if (humValue > 80) adviceList.push("üíß High humidity, it may feel hotter.");

      return adviceList;
    }

    // Marker c√°c city
    const cities = {
      "Hanoi": [21.0285, 105.8542],
      "Ho Chi Minh": [10.7769, 106.7009]
    };

    for (let city in cities) {
      L.marker(cities[city]).addTo(map).on("click", () => updateWeather(city));
    }

    // Load m·∫∑c ƒë·ªãnh
    updateWeather("Hanoi");
  </script>
</body>

</html>

