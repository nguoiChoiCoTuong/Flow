<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Flow</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="icon" href="images/sea-waves.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background-color: skyblue;
    }

    #navbar {
      background-color: #A2D4F4;
      color: navy;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    #navbar .brand {
      display: flex;
      align-items: center;
      font-size: 1.5rem;
      font-weight: bold;
    }

    #navbar .brand img {
      width: 24px;
      height: 24px;
      margin-right: 10px;
    }

    #navbar #date-display {
      font-size: 1rem;
    }

    #content {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    #weather-info {
      width: 35%;
      padding: 20px;
      background-color: skyblue;
      overflow-y: auto;
    }

    #map {
      flex: 1;
    }

    .card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      padding: 15px;
      margin-bottom: 20px;
    }

    .forecast-day {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px solid #eee;
    }

    .forecast-day:last-child {
      border-bottom: none;
    }

    #unit-btn {
      margin-left: 10px;
      padding: 5px 10px;
      cursor: pointer;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: white;
    }
  </style>
</head>

<body>
  <div id="navbar">
    <div class="brand">
      <img src="images/sea-waves.png" alt="Wave Logo">
      <span>Flow</span>
    </div>
    <div id="date-display"></div>
  </div>
  <div id="content">
    <div id="weather-info">
      <div class="card">
        <h2 id="city-name">Ha Noi</h2>
        <p id="desc">---</p>
        <p>
          <i class="fa-solid fa-temperature-high" style="color: gray"></i>
          <b>Temperature:</b>
          <span id="temp">-- ¬∞C</span>
          <button id="unit-btn" onclick="toggleUnit()">¬∞C/¬∞F</button>
        </p>
        <p>
          <i class="fa-solid fa-water" style="color: blue"></i>
          <b>Humidity:</b> <span id="humidity">--%</span>
        </p>
        <p>
          <i class="fa-solid fa-wind" style="color: green"></i>
          <b>Wind:</b> <span id="wind">-- km/h</span>
        </p>
        <p>
          <i class="fa-solid fa-eye" style="color: purple"></i>
          <b>Visibility:</b> <span id="visibility">-- km</span>
        </p>
      </div>
      <div class="card">
        <h3>5-Day Forecast</h3>
        <div id="forecast-container"></div>
      </div>
      <div class="card">
        <h3>Advice</h3>
        <ul id="advice-list"></ul>
      </div>
    </div>
    <div id="map"></div>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // T·∫°o map
    var map = L.map("map").setView([16, 107], 5);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "¬© OpenStreetMap"
    }).addTo(map);

    // Bi·∫øn global
    let currentUnit = "C"; // "C" ho·∫∑c "F"
    let currentCity = "Hanoi";

    // D·ªØ li·ªáu tƒ©nh demo (temp, min, max ƒë·ªÅu l√† s·ªë ¬∞C)
    const weatherData = {
      "Hanoi": {
        current: { temp: 28, desc: "‚òÄÔ∏è Clear Sky", humidity: 70, wind: 8, visibility: 10 },
        forecast: [
          { day: "Today", icon: "‚òÄÔ∏è", min: 24, max: 30 },
          { day: "Tomorrow", icon: "‚õÖ", min: 23, max: 29 },
          { day: "Wednesday", icon: "üåßÔ∏è", min: 21, max: 27 },
          { day: "Thursday", icon: "‚òÄÔ∏è", min: 20, max: 26 },
          { day: "Friday", icon: "‚õÖ", min: 22, max: 28 }
        ]
      },
      "Ho Chi Minh": {
        current: { temp: 32, desc: "‚õÖ Partly Cloudy", humidity: 65, wind: 10, visibility: 12 },
        forecast: [
          { day: "Today", icon: "‚õÖ", min: 26, max: 34 },
          { day: "Tomorrow", icon: "‚òÄÔ∏è", min: 25, max: 33 },
          { day: "Wednesday", icon: "üåßÔ∏è", min: 24, max: 32 },
          { day: "Thursday", icon: "üå©Ô∏è", min: 25, max: 34 },
          { day: "Friday", icon: "‚òÄÔ∏è", min: 26, max: 35 }
        ]
      },
      "Da Nang": {
        current: { temp: 30, desc: "‚òÄÔ∏è Sunny", humidity: 68, wind: 12, visibility: 9 },
        forecast: [
          { day: "Today", icon: "‚òÄÔ∏è", min: 25, max: 31 },
          { day: "Tomorrow", icon: "‚õÖ", min: 24, max: 30 },
          { day: "Wednesday", icon: "üåßÔ∏è", min: 23, max: 29 },
          { day: "Thursday", icon: "‚òÄÔ∏è", min: 24, max: 31 },
          { day: "Friday", icon: "‚õÖ", min: 25, max: 32 }
        ]
      },
      "Can Tho": {
        current: { temp: 29, desc: "üåßÔ∏è Light Rain", humidity: 75, wind: 7, visibility: 8 },
        forecast: [
          { day: "Today", icon: "üåßÔ∏è", min: 24, max: 30 },
          { day: "Tomorrow", icon: "‚õÖ", min: 23, max: 29 },
          { day: "Wednesday", icon: "‚òÄÔ∏è", min: 22, max: 28 },
          { day: "Thursday", icon: "üå©Ô∏è", min: 23, max: 29 },
          { day: "Friday", icon: "üåßÔ∏è", min: 24, max: 30 }
        ]
      }
    };

    // H√†m ƒë·ªïi ƒë·ªãnh d·∫°ng nhi·ªát ƒë·ªô
    function formatTemp(celsiusValue) {
      if (currentUnit === "C") {
        return Math.round(celsiusValue) + "¬∞C";
      } else {
        return Math.round((celsiusValue * 9 / 5) + 32) + "¬∞F";
      }
    }

    // H√†m ƒë·ªïi ƒë∆°n v·ªã
    function toggleUnit() {
      currentUnit = currentUnit === "C" ? "F" : "C";
      updateWeather(currentCity);
    }

    // H√†m update UI
    function updateWeather(city) {
      currentCity = city;
      const data = weatherData[city];

      document.getElementById("city-name").innerText = city;
      document.getElementById("temp").innerText = formatTemp(data.current.temp);
      document.getElementById("desc").innerText = data.current.desc;
      document.getElementById("humidity").innerText = data.current.humidity + "%";
      document.getElementById("wind").innerText = data.current.wind + " km/h";
      document.getElementById("visibility").innerText = data.current.visibility + " km";

      // Advice
      const adviceListElem = document.getElementById("advice-list");
      adviceListElem.innerHTML = "";
      const advices = generateAdvice(data.current.temp, data.current.desc, data.current.humidity, data.current.wind);
      advices.forEach(a => {
        const li = document.createElement("li");
        li.textContent = a;
        adviceListElem.appendChild(li);
      });

      // Forecast
      const forecastContainer = document.getElementById("forecast-container");
      forecastContainer.innerHTML = "";
      data.forecast.forEach(f => {
        const div = document.createElement("div");
        div.className = "forecast-day";
        div.innerHTML = `<span>${f.icon} ${f.day}</span><span>${formatTemp(f.min)} - ${formatTemp(f.max)}</span>`;
        forecastContainer.appendChild(div);
      });
    }

    // H√†m t·∫°o l·ªùi khuy√™n
    function generateAdvice(temp, desc, humidity, wind) {
      const adviceList = [];
      // Temperature
      if (temp < 0) adviceList.push("ü•∂ It's freezing! Wear multiple layers, a warm coat, hat, and gloves.");
      else if (temp < 10) adviceList.push("üß• It's cold. A jacket or sweater is recommended.");
      else if (temp > 30) adviceList.push("üî• It's very hot. Wear light clothing and apply sunscreen.");
      else if (temp > 25) adviceList.push("üòé Nice weather! Light clothing will be comfortable.");

      // Condition
      if (desc.includes("Rain") || desc.includes("üåßÔ∏è")) adviceList.push("‚òî Don't forget your umbrella and waterproof shoes.");
      if (desc.includes("Snow") || desc.includes("‚ùÑÔ∏è")) adviceList.push("‚ö†Ô∏è Slippery roads. Wear non-slip shoes and be careful.");
      if (desc.includes("Clear") || desc.includes("‚òÄÔ∏è")) adviceList.push("üï∂Ô∏è Great day! Sunglasses are recommended.");

      // Wind
      if (wind > 25) adviceList.push("üí® Strong winds today. Secure loose items and be careful with umbrellas.");
      else if (wind > 15) adviceList.push("üçÉ Moderate winds. A light jacket may help with wind chill.");

      // Humidity
      if (humidity > 80) adviceList.push("üíß High humidity. It may feel warmer than the actual temperature.");

      return adviceList;
    }

    // T·∫°o marker
    const cities = {
      "Hanoi": [21.0285, 105.8542],
      "Ho Chi Minh": [10.7769, 106.7009],
      "Da Nang": [16.0471, 108.2068],
      "Can Tho": [10.0452, 105.7469]
    };
    for (let city in cities) {
      L.marker(cities[city]).addTo(map).on("click", () => updateWeather(city));
    }

    // H√†m hi·ªÉn th·ªã ng√†y th√°ng nƒÉm
    function updateDate() {
      const now = new Date();
      const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
      document.getElementById("date-display").textContent = now.toLocaleDateString('en-GB', options);
    }

    // C·∫≠p nh·∫≠t ng√†y m·ªói gi√¢y
    setInterval(updateDate, 1000);

    // Load m·∫∑c ƒë·ªãnh H√† N·ªôi v√† ng√†y
    updateWeather("Hanoi");
    updateDate();
  </script>
</body>

</html>
